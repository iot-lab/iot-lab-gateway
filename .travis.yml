language: generic
sudo: required

services:
  - docker

before_install:
  - docker pull fitiotlab/iot-lab-gateway:latest
  - docker build -t iot-lab-gateway .
  - docker build -t iot-lab-gateway-test tests

script:
  - >
    docker run -v gateway_code:/home/iot-lab-gateway/gateway_code
    -v $CWD/tests_utils/cfg_dir:/var/local/config
    -e BOARD_TYPE=m3
    -e CONTROL_NODE_TYPE=no
    -e HOSTNAME=m3-00 
    -e IOTLAB_GATEWAY_NO_INTEGRATION_TESTS
    --privileged iot-lab-gateway-test
